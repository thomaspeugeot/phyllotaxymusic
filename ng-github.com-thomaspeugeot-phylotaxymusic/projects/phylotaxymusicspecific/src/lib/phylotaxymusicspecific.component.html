<as-split direction="horizontal">
    <as-split-area [size]="15">
        <lib-tree [GONG__StackPath]="StacksNames.SidebarTree" [name]="TreeNames.Sidebar"></lib-tree>
    </as-split-area>
    <as-split-area [size]="65">
      <!-- Parent container must be position: relative 
           so its absolutely positioned children
           can stack with z-index -->
      <div style="position: relative; width: 100%; height: 100%;">
        
        <!-- Diagram behind (z-index: 1) -->
        <lib-gongsvg-diagramming
          [GONG__StackPath]="StacksNames.GongsvgStackName"
          style="
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
          "
        >
        </lib-gongsvg-diagramming>
    
        <!-- Moving line in front (z-index: 2) -->
        <lib-substackcursorspecific
          style="
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
          "
        >
        </lib-substackcursorspecific>
      </div>
    </as-split-area>
    

    <as-split-area [size]="20">
      <as-split unit="pixel" direction="vertical">
        <as-split-area [size]="60">
          @if (frontRepo && frontRepo.array_Parameters[0]) {
            <mat-grid-list cols="12" [rowHeight]="rowHeight" gutterSize="16px">
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Side Length</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                  <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].SideLength}}</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider style="width: 100%;" 
                min="1.0" max="600.0" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].SideLength" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
              
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Origin X </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].OriginX}}</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="7" rowspan="1">
                  <mat-slider  min="-100.0" max="600.0" step="10" 
                  showTickMarks discrete [displayWith]="formatLabel">
                      <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].OriginX" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Origin Y </h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].OriginY}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="0.0" max="3000.0" step="50" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].OriginY" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>

            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Spiral Origin X </h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].SpiralOriginX}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="0.0" max="3000.0" step="50" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].SpiralOriginX" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>

            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Spiral Origin Y </h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].SpiralOriginY}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="0.0" max="3000.0" step="50" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].SpiralOriginY" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>

            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Spiral Initial Radius </h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].SpiralRadiusRatio}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="0.0" max="5.0" step="0.01" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].SpiralRadiusRatio" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>

            </mat-grid-list>
          }
        </as-split-area>
        <as-split-area [size]="60">
          @if (frontRepo && frontRepo.array_Parameters[0]) {

            <mat-grid-list cols="12" [rowHeight]="rowHeight" gutterSize="16px">
           
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Inside Angle </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].InsideAngle}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="60.0" max="120.0" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].InsideAngle" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
            
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Bezier Strength </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].BezierControlLengthRatio}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0.0" max="4.0" step="0.01" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].BezierControlLengthRatio" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
            
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">M </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].M}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="1" max="20" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].M" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
            
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">N </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].N}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="1" max="20" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].N" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
      
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Z </h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].Z}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="1" max="120" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].Z" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
      
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">S Bezier Strength</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].SpiralBezierStrength}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0.0" max="10.0" step="0.1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].SpiralBezierStrength" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Nb Interpol Points</h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].NbInterpolationPoints}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="1" max="50" step="1" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].NbInterpolationPoints" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>
            
            <mat-grid-tile colspan="3" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">Stack Height</h4>
            </mat-grid-tile>
            <mat-grid-tile colspan="2" rowspan="1">
              <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].StackHeight}}</h4>
            </mat-grid-tile>              
            <mat-grid-tile colspan="7" rowspan="1">
              <mat-slider min="1" max="8" step="1" showTickMarks discrete [displayWith]="formatLabel">
                <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].StackHeight" (input)="input($event)">
              </mat-slider>
            </mat-grid-tile>
            

          </mat-grid-list>
          }
        </as-split-area>
        <as-split-area [size]="$any('*')">
          @if (frontRepo && frontRepo.array_Parameters[0]) {

            <mat-grid-list cols="12" [rowHeight]="rowHeight" gutterSize="16px">
           
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Pitch Height</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].PitchHeight}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0" max="0.1" step="0.001" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].PitchHeight" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Nb Beats in Theme</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].NbOfBeatsInTheme}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="1" max="64" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].NbOfBeatsInTheme" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">BeatsPerSecond</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].BeatsPerSecond}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0" max="20" step="0.05" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].BeatsPerSecond" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">1st voice X</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].FirstVoiceShiftX}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="-1" max="1" step="0.01" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].FirstVoiceShiftX" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">1st voice Y</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].FirstVoiceShiftY}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="-1" max="4" step="0.01" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].FirstVoiceShiftY" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">2nd voice pitch diff</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].PitchDifference}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="-12" max="12" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].PitchDifference" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Level</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].Level}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0" max="20" step="0.1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].Level" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Minor / Major</h4>
              </mat-grid-tile>          
              <mat-grid-tile colspan="9" rowspan="1">

                <mat-radio-group [(ngModel)]="frontRepo.array_Parameters[0].IsMinor" (change)="inputMatRadio($event)">
                  <mat-radio-button [value]="false">Major</mat-radio-button>
                  <mat-radio-button [value]="true">Minor</mat-radio-button>
                </mat-radio-group>
          
              </mat-grid-tile>

              <mat-grid-tile colspan="3" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">Actual Beats Shift</h4>
              </mat-grid-tile>
              <mat-grid-tile colspan="2" rowspan="1">
                <h4 style="margin-left: 8px; width: 100%;">{{frontRepo.array_Parameters[0].ActualBeatsTemporalShift}}</h4>
              </mat-grid-tile>              
              <mat-grid-tile colspan="7" rowspan="1">
                <mat-slider min="0" max="20" step="1" showTickMarks discrete [displayWith]="formatLabel">
                  <input matSliderThumb [(ngModel)]="frontRepo.array_Parameters[0].ActualBeatsTemporalShift" (input)="input($event)">
                </mat-slider>
              </mat-grid-tile>
            </mat-grid-list>
          }
          @if (frontRepo && frontRepo.array_Parameters[0]) {
            <!-- Display checkboxes for each note -->
            <div *ngFor="let note of [].constructor(frontRepo.array_Parameters[0].NbOfBeatsInTheme); let i = index">
              <label>
                <input 
                  type="checkbox" 
                  [checked]="isNotePlayed(frontRepo.array_Parameters[0].ThemeBinaryEncoding, i)" 
                  (change)="toggleNote(i)" 
                />
                {{ i + 1 }}
              </label>
              <label>
                <input 
                  type="checkbox" 
                  [checked]="isNotePlayedWithOffset(frontRepo.array_Parameters[0].ThemeBinaryEncoding, i)" 
                  disabled=true
                />
              </label>
            </div>
            <p>
              Current Encoding: {{ frontRepo.array_Parameters[0].ThemeBinaryEncoding }}
            </p>
          }
        </as-split-area>

        <as-split-area [size]="150">
          <lib-gongtone style="margin-left: 8px; width: 100%;" GONG__StackPath="gongtone">

          </lib-gongtone>
        </as-split-area>
      </as-split>

    </as-split-area>
</as-split>